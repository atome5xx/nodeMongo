<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title><%= materiel ? 'Modifier' : 'Ajouter' %> un Matériel</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header>
    <h1><%= materiel ? 'Modifier' : 'Ajouter' %> un Matériel</h1>
    <a href="/materiels" class="btn">← Retour à la liste</a>
  </header>

  <!-- Affichage des erreurs -->
  <% if (errors && errors.length) { %>
    <div class="errors">
      <ul>
        <% errors.forEach(err => { %>
          <li><%= err.msg %></li>
        <% }) %>
      </ul>
    </div>
  <% } %>

  <form action="/materiels" method="POST">
    <% if (materiel) { %>
      <!-- method-override via champ caché -->
      <input type="hidden" name="_method" value="PUT">
      <input type="hidden" name="id" value="<%= materiel.id %>">
    <% } %>

    <label>
      Nom
      <input type="text" name="name" value="<%= materiel ? materiel.name : '' %>" required>
    </label>

    <label>
      Description
      <textarea name="description" required><%= materiel ? materiel.description : '' %></textarea>
    </label>

    <label>
      Numéro de série
      <input type="number" name="serieNumber" value="<%= materiel ? materiel.serieNumber : '' %>">
    </label>

    <label>
      URL de l’image
      <input type="url" name="picture" value="<%= materiel ? materiel.picture : '' %>">
    </label>

    <label>
      Disponible
      <!-- la valeur "on" sera castée en true dans le controller via !! -->
      <input type="checkbox" name="isDisponible" <%= materiel && materiel.isDisponible ? 'checked' : '' %>>
    </label>

    <label>
      État
      <select name="state" required>
        <option value="">-- Choisir --</option>
        <% ['Neuf','Correct','Bon','Mauvais'].forEach(s => { %>
          <option value="<%= s %>"
            <%= materiel && materiel.state === s ? 'selected' : '' %>>
              <%= s %>
          </option>
        <% }) %>
      </select>
    </label>

    <button type="submit" class="btn"><%= materiel ? 'Enregistrer' : 'Créer' %></button>
  </form>
</body>
</html>
